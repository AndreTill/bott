import * as gramio from 'gramio';
import { Plugin, Bot } from 'gramio';

/**
 *	This plugin collects `mediaGroup` from messages (**1** attachment = **1** message) using a **delay**
 *	if `mediaGroupId` is in the **MessageContext**, pass only **first** message further down the middleware chain with the `mediaGroup` key,
 *	which contains an **array** of messages of this **mediaGroup** (it also contains the first message).
 *
 * 	@example
 * ```ts
 * import { Bot } from "gramio";
 * import { mediaGroup } from "@gramio/media-group";
 *
 * const bot = new Bot(process.env.TOKEN as string)
 *     .extend(mediaGroup())
 *     .on("message", async (context) => {
 *         if (!context.mediaGroup) return;
 *
 *         return context.send(
 *             `Caption from the first message - ${context.caption}. MediaGroup contains ${context.mediaGroup.length} attachments`
 *         );
 *     })
 *     .onStart(({ info }) => console.log(`âœ¨ Bot ${info.username} was started!`));
 *
 * bot.start();
 * ```
 *	### Setup
 *
 *	You can change the duration of the delay in milliseconds by simply passing it like this:
 *
 *	```typescript
 *	    .extend(mediaGroup(1000)) // wait 1 second for message with mediaGroupId (refreshed after new message with it)
 *
 *	```
 *
 *	By default it `150 ms`.
 *
 * @param timeout duration of the delay in milliseconds (default is `150 ms`)
 */
declare function mediaGroup(timeout?: number): Plugin<{}, gramio.DeriveDefinitions & {
    message: {
        /** An array of messages from this media group */
        mediaGroup?: undefined;
    } | {
        /** An array of messages from this media group */
        mediaGroup: gramio.MessageContext<Bot<{}, gramio.DeriveDefinitions>>[] | undefined;
    };
    edited_message: {
        /** An array of messages from this media group */
        mediaGroup?: undefined;
    } | {
        /** An array of messages from this media group */
        mediaGroup: gramio.MessageContext<Bot<{}, gramio.DeriveDefinitions>>[] | undefined;
    };
    channel_post: {
        /** An array of messages from this media group */
        mediaGroup?: undefined;
    } | {
        /** An array of messages from this media group */
        mediaGroup: gramio.MessageContext<Bot<{}, gramio.DeriveDefinitions>>[] | undefined;
    };
    edited_channel_post: {
        /** An array of messages from this media group */
        mediaGroup?: undefined;
    } | {
        /** An array of messages from this media group */
        mediaGroup: gramio.MessageContext<Bot<{}, gramio.DeriveDefinitions>>[] | undefined;
    };
    business_message: {
        /** An array of messages from this media group */
        mediaGroup?: undefined;
    } | {
        /** An array of messages from this media group */
        mediaGroup: gramio.MessageContext<Bot<{}, gramio.DeriveDefinitions>>[] | undefined;
    };
    edited_business_message: {
        /** An array of messages from this media group */
        mediaGroup?: undefined;
    } | {
        /** An array of messages from this media group */
        mediaGroup: gramio.MessageContext<Bot<{}, gramio.DeriveDefinitions>>[] | undefined;
    };
}>;

export { mediaGroup };
