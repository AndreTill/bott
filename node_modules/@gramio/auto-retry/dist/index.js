import { Plugin } from 'gramio';

function autoRetry() {
  return new Plugin("@gramio/auto-retry").onResponseError(
    async (error, api) => {
      if (error.payload?.retry_after) {
        setTimeout(
          //@ts-expect-error
          () => api[error.method](error.params),
          error.payload.retry_after * 1e3
        );
      }
    }
  );
}

export { autoRetry };
